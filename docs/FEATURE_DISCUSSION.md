# DSE Speaking 功能讨论与规划

> 本文档用于记录项目新功能的讨论、构思和规划。  
> 每次讨论后更新状态，方便追踪进度。

---

## 📋 功能列表

| # | 功能名称 | 状态 | 优先级 |
|---|---------|------|--------|
| 1 | 用户设置 - 练测等级展示 | 💬 讨论中 | - |
| 2 | 用户设置 - 语言偏好 | 💬 讨论中 | - |
| 3 | 房间角色 - Marker（评分员） | 💬 讨论中 | - |
| 4 | 房间角色 - 观众（Spectator） | 💬 讨论中 | - |

---

## 1. 用户设置 - 练测等级展示

**提出日期：** 2026-02-11

### 描述

在「设置」页面中，让用户可以看到自己的练测等级（Practice Level）。这个等级可以反映用户在 DSE Speaking 练习中的表现和进步程度。

### 待讨论的问题

- **等级体系设计：** 等级怎么划分？是用 DSE 官方的 1-7 级（对应 U, 1, 2, 3, 4, 5, 5*, 5**），还是自定义一套练习等级？
- **等级计算方式：** 等级是用户自评、同伴互评，还是根据练习次数 / 时长自动计算？
- **展示形式：** 用数字、进度条、徽章、还是雷达图来展示？
- **是否公开：** 等级是否在房间列表 / 用户头像旁展示，方便匹配水平相近的队友？

### 初步想法

```
用户设置页
├── 个人资料
│   ├── 头像 / 昵称
│   ├── 练测等级（Level）  ← 新功能
│   └── ...
├── 语言偏好               ← 新功能
└── 账号设置
```

---

## 2. 用户设置 - 语言偏好

**提出日期：** 2026-02-11

### 描述

让用户在设置中标注自己熟练使用的语言，例如：

- **粤语（Cantonese）**
- **普通话（Mandarin）**
- **英语（English）**
- 其他语言

### 应用场景

- **房间匹配：** 用户可以找到说相同母语的队友，方便课外沟通 / 讨论策略
- **房间筛选：** 在房间列表中可以按语言偏好筛选
- **用户档案展示：** 在个人卡片上显示语言标签

### 待讨论的问题

- **多选 vs 单选：** 用户可以选多种语言吗？（比如粤语 + 普通话都流利）
- **熟练程度：** 是否需要标注熟练程度（如母语 / 流利 / 一般），还是只标注会说的语言？
- **跟房间的关系：** 创建房间时，是否可以设定「房间语言」来吸引同语言的人？

### 初步想法

语言偏好可以作为用户 profile 的一部分，存在 Supabase 的用户表中。大致的数据结构：

```sql
-- 可能的字段扩展（profiles 表）
ALTER TABLE profiles ADD COLUMN languages text[] DEFAULT '{}';
ALTER TABLE profiles ADD COLUMN practice_level int DEFAULT 0;
```

---

## 3. 房间角色 - Marker（评分员 / 考官）

**提出日期：** 2026-02-11

### 描述

除了现有的 4 位练习者（Candidate）之外，房间还支持一个 **Marker** 角色。Marker 模拟真实考试中的考官，负责观察讨论过程并给予评分或反馈。

### 角色定位

```
房间角色结构
├── Candidate × 4（练习者，参与讨论）
├── Marker × 1（评分员，观察 + 评分）
└── Spectator × ∞（观众，仅观看）
```

- Marker 可以**听到 / 看到**整个讨论过程
- Marker **不参与**小组讨论发言
- Marker 在 Part B 阶段可以**提出跟进问题**（模拟考官角色）
- Marker 可以对每位 Candidate 进行**评分 / 写评语**

### 待讨论的问题

- **谁可以当 Marker？** 任何人都可以？还是需要达到一定等级 / 获得资格？
- **评分体系：** Marker 按 DSE 官方四项标准打分（Pronunciation、Communication Strategy、Vocabulary、Ideas），还是简化版？
- **评分时机：** 实时边听边评，还是讨论结束后统一评分？
- **反馈机制：** Marker 的评分和评语怎么呈现给 Candidate？是即时的还是结束后查看？
- **Marker 限额：** 一个房间只允许 1 个 Marker，还是可以有多个？
- **Part B 互动：** Marker 在 Part B 个人回应阶段，是否由 Marker 来提问（像真正考官一样）？

### 初步想法

Marker 角色让练习更接近真实考试体验。可以考虑：
- 房间创建时可以设定「是否需要 Marker」
- Marker 有专属的评分界面，四项评分 + 文字评语
- 练习结束后，Candidate 可以查看 Marker 给的分数和反馈

---

## 4. 房间角色 - 观众（Spectator）

**提出日期：** 2026-02-11

### 描述

房间支持**无限制**数量的观众加入。观众只能观看和收听练习过程，不能发言或参与讨论。

### 角色定位

- 观众可以**看到 / 听到**整个练习过程（音视频）
- 观众**不能**发言、不占 Candidate 名额
- 观众数量**不设上限**

### 应用场景

- **学习观摩：** 新手可以先看别人怎么练，学习讨论技巧和策略
- **老师旁听：** 老师 / 导师可以作为观众旁听学生的练习
- **朋友围观：** 朋友之间可以互相观摩，增加趣味性
- **直播 / 录播：** 未来可以扩展为公开观摩的练习赛

### 待讨论的问题

- **观众可见性：** 练习者能看到有多少观众在看吗？会不会造成压力？
  - 方案 A：显示观众数量但不显示具体是谁
  - 方案 B：完全隐藏观众存在
  - 方案 C：显示观众列表（透明模式）
- **观众互动：** 观众之间能不能聊天（文字弹幕 / 聊天室）？
- **权限控制：** 房间创建者能不能设置「禁止观众」或「仅限邀请观众」？
- **观众转换：** 如果有 Candidate 退出，观众能不能顶上变成练习者？
- **技术考量：** 大量观众的音视频分发需要考虑性能（可能需要用 SFU 架构或直播流方案）

### 初步想法

```
房间加入流程
│
├── 选择角色
│   ├── 🎤 Candidate（练习者）— 最多 4 人
│   ├── 📋 Marker（评分员）— 最多 1 人
│   └── 👀 Spectator（观众）— 不限人数
│
└── 进入房间
```

数据结构方面，`room_participants` 表可能需要加一个 `role` 字段：

```sql
-- room_participants 表扩展
-- role: 'candidate' | 'marker' | 'spectator'
ALTER TABLE room_participants ADD COLUMN role text DEFAULT 'candidate';
```

---

## 🗓 讨论记录

### 2026-02-11 - 初始讨论

- 提出了两个新功能方向：练测等级 + 语言偏好
- 下一步：确定等级体系和语言选项的具体设计

### 2026-02-11 - 房间角色讨论

- 新增 Marker（评分员）角色：1 人，负责评分和 Part B 提问
- 新增 Spectator（观众）角色：不限人数，仅观看
- 房间角色结构确定为：Candidate × 4 + Marker × 1 + Spectator × ∞
- 下一步：讨论 Marker 评分体系、观众可见性策略

---

*最后更新：2026-02-11*
